from anthropic import Anthropic
from config.config import Config

class ClaudeService:
    def __init__(self, api_key: str):
        self.claude = Anthropic(api_key=api_key)

    async def generate_post(self, topic: str, language: str) -> str:
        prompt = self._get_prompt(topic, language)
        response = self.claude.messages.create(
            model="claude-3-7-sonnet-20250219",
            max_tokens=1000,
            messages=[{"role": "user", "content": prompt}]
        )
        return response.content[0].text

    def _get_prompt(self, topic: str, language: str) -> str:
        if language == 'ru':
            return f"""–ù–∞–ø–∏—à–∏ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ—Å—Ç –¥–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –Ω–∞ —Ç–µ–º—É: {topic}.
            –ü–æ—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º:
            - –ó–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–µ–µ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ
            - –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∞–∫—Ç—ã –∏–ª–∏ —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ —Ç–µ–º–µ
            - –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å —á–∏—Ç–∞—Ç–µ–ª—è
            - –ß–µ—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –∞–±–∑–∞—Ü–∞–º–∏
            - –ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é –≤ –∫–æ–Ω—Ü–µ (–±–µ–∑ —Ö—ç—à—Ç–µ–≥–æ–≤)
            - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç–º–æ–¥–∑–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è
            - –î–ª–∏–Ω–∞ 1000-1500 —Å–∏–º–≤–æ–ª–æ–≤
            - –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ö—ç—à—Ç–µ–≥–∏
            - –í –∫–æ–Ω—Ü–µ –¥–æ–±–∞–≤–∏—Ç—å: 'üëâ –ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –Ω–∞ –Ω–∞—à –∫–∞–Ω–∞–ª https://t.me/+xCL6A1tWo2dmN2Zi!'"""
        return f"""–ù–∞–ø–∏—à–∏ –ø—Ä–∏–≤–∞–±–ª–∏–≤–∏–π –ø–æ—Å—Ç –¥–ª—è —Å–æ—Ü—ñ–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ –Ω–∞ —Ç–µ–º—É: {topic}.
        –ü–æ—Å—Ç –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –º–æ–≤–æ—é —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–∏—Ç–µ—Ä—ñ—è–º:
        - –ó–∞—Ö–æ–ø–ª—é—é—á–∏–π –≤—Å—Ç—É–ø, —è–∫–∏–π –ø—Ä–∏–≤–µ—Ä—Ç–∞—î —É–≤–∞–≥—É
        - –¶—ñ–∫–∞–≤—ñ —Ñ–∞–∫—Ç–∏ –∞–±–æ —É–Ω—ñ–∫–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –∑–∞ —Ç–µ–º–æ—é
        - –ï–º–æ—Ü—ñ–π–Ω–∞ –∑–∞–ª—É—á–µ–Ω—ñ—Å—Ç—å —á–∏—Ç–∞—á–∞
        - –ß—ñ—Ç–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑ –∞–±–∑–∞—Ü–∞–º–∏
        - –ó–∞–∫–ª–∏–∫ –¥–æ –¥—ñ—ó –Ω–∞–ø—Ä–∏–∫—ñ–Ω—Ü—ñ (–±–µ–∑ —Ö–µ—à—Ç–µ–≥—ñ–≤)
        - –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –µ–º–æ–¥–∑—ñ –¥–ª—è –∫—Ä–∞—â–æ–≥–æ —Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è
        - –î–æ–≤–∂–∏–Ω–∞ 1000-1500 —Å–∏–º–≤–æ–ª—ñ–≤
        - –ù–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ö–µ—à—Ç–µ–≥–∏
        - –ù–∞–ø—Ä–∏–∫—ñ–Ω—Ü—ñ –¥–æ–¥–∞—Ç–∏: 'üëâ –ü—ñ–¥–ø–∏—Å—É–π—Ç–µ—Å—å –Ω–∞ –Ω–∞—à –∫–∞–Ω–∞–ª https://t.me/+xCL6A1tWo2dmN2Zi!'"""